SELECT FUN.cvCodFil AS RD_FILIAL, RIGHT(FUN.ccVarFun,7) AS RD_MAT, 
(CASE FicFin.cvCodEve
WHEN	'0008'	THEN	'011' WHEN	'0051'	THEN	'013' WHEN	'0270'	THEN	'015' WHEN	'0172'	THEN	'016' WHEN	'0621'	THEN	'020'
WHEN	'0283'	THEN	'024' WHEN	'0036'	THEN	'030' WHEN	'0943'	THEN	'036' WHEN	'0782'	THEN	'037' WHEN	'1324'	THEN	'040' 
WHEN	'1635'	THEN	'041' WHEN	'0175'	THEN	'050' WHEN	'0096'	THEN	'052' WHEN	'0842'	THEN	'054' WHEN	'0836'	THEN	'057'
WHEN	'1437'	THEN	'060' WHEN	'1641'	THEN	'061' WHEN	'0353'	THEN	'063' WHEN	'1571'	THEN	'064' WHEN	'0029'	THEN	'066'
WHEN	'1573'	THEN	'067' WHEN	'0776'	THEN	'081' WHEN	'0980'	THEN	'086' WHEN	'1024'	THEN	'088' WHEN	'0176'	THEN	'092'
WHEN	'0061'	THEN	'094' WHEN	'0099'	THEN	'100' WHEN	'0123'	THEN	'101' WHEN	'0703'	THEN	'116' WHEN	'0865'	THEN	'121' 
WHEN	'1025'	THEN	'123' WHEN	'0791'	THEN	'174' WHEN	'0014'	THEN	'301' WHEN	'0057'	THEN	'302' WHEN	'0016'	THEN	'304'
WHEN	'0058'	THEN	'305' WHEN	'0658'	THEN	'306' WHEN	'1621'	THEN	'307' WHEN	'0015'	THEN	'309' WHEN	'0059'	THEN	'310' 
WHEN	'0657'	THEN	'311' WHEN	'0212'	THEN	'315' WHEN	'1118'	THEN	'317' WHEN	'0066'	THEN	'319' WHEN	'0009'	THEN	'325'  
WHEN	'0010'	THEN	'324' WHEN	'0017'	THEN	'336' WHEN	'0738'	THEN	'340' WHEN	'0739'	THEN	'341' WHEN	'0840'	THEN	'344'
WHEN	'0213'	THEN	'351' WHEN	'0007'	THEN	'361' WHEN	'0044'	THEN	'362' WHEN	'1215'	THEN	'364' 
WHEN	'1630'	THEN (CASE WHEN FicFin.cvVlrFimFicFin IN (SELECT MAX(FIC2.cvVlrFimFicFin) FROM FicFin AS FIC2
WHERE FIC2.cvCodEve = '1630' GROUP BY FIC2.cvCodFun,FIC2.cvCodEve, 
(CONVERT(VARCHAR,FIC2.cvAnoFicFin)+ RIGHT('00' + RTRIM(FIC2.cvMesFicFin),2))) THEN '385' 
WHEN FicFin.cvVlrFimFicFin IN (SELECT MIN(FIC3.cvVlrFimFicFin) FROM FicFin AS FIC3
WHERE FIC3.cvCodEve = '1630' GROUP BY FIC3.cvCodFun,FIC3.cvCodEve, 
(CONVERT(VARCHAR,FIC3.cvAnoFicFin)+ RIGHT('00' + RTRIM(FIC3.cvMesFicFin),2))) THEN 'Z63'ELSE 'Z63' END)
WHEN	'0006'	THEN	'400' WHEN	'0025'	THEN	'401' WHEN	'0075'	THEN	'402' 
WHEN	'0084'	THEN	(CASE WHEN FicFin.cvVlrFimFicFin IN (SELECT MAX(FIC2.cvVlrFimFicFin) FROM FicFin AS FIC2
WHERE FIC2.cvCodEve = '0084' GROUP BY FIC2.cvCodFun,FIC2.cvCodEve, 
(CONVERT(VARCHAR,FIC2.cvAnoFicFin)+ RIGHT('00' + RTRIM(FIC2.cvMesFicFin),2))) THEN '403' 
WHEN FicFin.cvVlrFimFicFin IN (SELECT MIN(FIC3.cvVlrFimFicFin) FROM FicFin AS FIC3
WHERE FIC3.cvCodEve = '0084' GROUP BY FIC3.cvCodFun,FIC3.cvCodEve, 
(CONVERT(VARCHAR,FIC3.cvAnoFicFin)+ RIGHT('00' + RTRIM(FIC3.cvMesFicFin),2))) THEN 'Z65'ELSE 'Z65' END)  
WHEN	'0217'	THEN	'404' WHEN	'0076'	THEN	'405' WHEN	'0026'	THEN	'411' WHEN	'0077'	THEN	'412' WHEN	'0052'	THEN	'413' WHEN	'0018'	THEN	'415'
WHEN	'0078'	THEN	'421' WHEN	'0079'	THEN	'422' WHEN	'0043'	THEN	'431' WHEN	'0115'	THEN	'432' WHEN	'0280'	THEN	'433'
WHEN	'1441'	THEN	'434' WHEN	'0743'	THEN	'442' WHEN	'0048'	THEN	'451' WHEN	'0373'	THEN	'461' WHEN	'1628'	THEN	'464' 
WHEN	'0060'	THEN	'470' WHEN	'0174'	THEN	'471' WHEN	'0700'	THEN	'474' WHEN	'1327'	THEN	'476' WHEN	'1085'	THEN	'477'
WHEN	'1643'	THEN	'478' WHEN	'0277'	THEN	'480' WHEN	'1103'	THEN	'481' WHEN	'1644'	THEN	'482' WHEN	'1591'	THEN	'490'
WHEN	'0368'	THEN	'492' WHEN	'0198'	THEN	'493' WHEN	'0042'	THEN	'495' WHEN	'0211'	THEN	'501' WHEN	'0050'	THEN	'507'
WHEN	'0263'	THEN	'517' WHEN	'0294'	THEN	'520' WHEN	'0236'	THEN	'523' WHEN	'1457'	THEN	'525' WHEN	'1645'	THEN	'Z01'
WHEN	'1646'	THEN	'Z02' WHEN	'0642'	THEN	'Z03' 
WHEN	'1631'	THEN (CASE WHEN FicFin.cvVlrFimFicFin IN (SELECT MAX(FIC4.cvVlrFimFicFin) FROM FicFin AS FIC4
WHERE FIC4.cvCodEve = '1631' GROUP BY FIC4.cvCodFun,FIC4.cvCodEve, 
(CONVERT(VARCHAR,FIC4.cvAnoFicFin)+ RIGHT('00' + RTRIM(FIC4.cvMesFicFin),2))) THEN 'Z04'
WHEN FicFin.cvVlrFimFicFin IN (SELECT MIN(FIC5.cvVlrFimFicFin) FROM FicFin AS FIC5
WHERE FIC5.cvCodEve = '1631' GROUP BY FIC5.cvCodFun,FIC5.cvCodEve, 
(CONVERT(VARCHAR,FIC5.cvAnoFicFin)+ RIGHT('00' + RTRIM(FIC5.cvMesFicFin),2))) THEN 'Z64' ELSE 'Z04' END) 
WHEN	'0074'	THEN	'Z05' WHEN	'0022'	THEN	'Z06'
WHEN	'0209'	THEN	'Z07' WHEN	'0665'	THEN	'Z08' WHEN	'0167'	THEN	'Z09' WHEN	'0027'	THEN	'Z10' WHEN	'1150'	THEN	'Z11'
WHEN	'1414'	THEN	'Z12' WHEN	'0820'	THEN	'Z13' WHEN	'1544'	THEN	'Z14' WHEN	'1632'	THEN	'Z15' WHEN	'0845'	THEN	'Z16'
WHEN	'0063'	THEN	'Z17' WHEN	'0281'	THEN	'Z18' WHEN	'1548'	THEN	'Z19' WHEN	'0039'	THEN	'Z20' WHEN	'1647'	THEN	'Z21'
WHEN	'1642'	THEN	'Z22' WHEN	'1648'	THEN	'Z23' WHEN	'0944'	THEN	'Z24' WHEN	'0178'	THEN	'Z25' WHEN	'0219'	THEN	'Z26'
WHEN	'0011'	THEN	'Z27' WHEN	'0091'	THEN	'Z28' WHEN	'1409'	THEN	'Z29' WHEN	'1226'	THEN	'Z30' WHEN	'1192'	THEN	'Z31'
WHEN	'0625'	THEN	'Z32' WHEN	'0122'	THEN	'Z33' WHEN	'1627'	THEN	'Z34' WHEN	'1509'	THEN	'Z35' WHEN	'1036'	THEN	'Z36'
WHEN	'1054'	THEN	'Z37' WHEN	'1636'	THEN	'Z38' WHEN	'1653'	THEN	'Z39' WHEN	'0227'	THEN	'Z40' WHEN	'0249'	THEN	'Z41'
WHEN	'1634'	THEN	'Z42' WHEN	'1652'	THEN	'Z43' WHEN	'1655'	THEN	'Z44' WHEN	'1656'	THEN	'Z45' WHEN	'1328'	THEN	'Z46'
WHEN	'0231'	THEN	'Z47' WHEN	'1547'	THEN	'Z48' WHEN	'1624'	THEN	'Z49' WHEN	'1422'	THEN	'Z50' WHEN	'1065'	THEN	'Z51'
WHEN	'1089'	THEN	'Z52' WHEN	'0181'	THEN	'486' WHEN	'0184'	THEN	'Z54' WHEN	'1649'	THEN	'Z55' WHEN	'1640'	THEN	'Z56'
WHEN	'1546'	THEN	'Z57' WHEN	'1453'	THEN	'Z58' WHEN	'1106'	THEN	'Z59' WHEN	'0019'	THEN	'Z60' WHEN	'1651'	THEN	'Z61'
WHEN	'0684'	THEN	'Z62' WHEN  '0001' 	THEN 	'657'  ELSE 'XXX' END) AS RD_PD,
( CASE WHEN FicFin.cvCodEve IN (SELECT cvCodEve FROM Evento
WHERE ccNomEve LIKE '%HORA%' OR ccNomEve LIKE '%EXTRA%' OR ccNomEve LIKE '%DSR%' OR ccNomEve LIKE '%H.E.%'
OR ccNomEve LIKE '%HRS%') THEN 'H' ELSE 'V' END) AS RD_TIPO1,
FicFin.cvVlrBasFicFin AS RD_HORAS, FicFin.cvVlrFimFicFin AS RD_VALOR,
(CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)) AS RD_DATARQ,
(CASE WHEN FicFin.cvCodEve='0211' 
AND (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'20') = '20120120'
THEN (CONVERT(VARCHAR,FicFin.cvAnoFicFin-1)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin+11),2)+'20')
WHEN FicFin.cvCodEve='0211' 
AND (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'20') <> '20120120'
THEN (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin-01),2)+'20')
ELSE (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'04') END )AS RD_DATPGT,
(CASE FUN.cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN '2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN '2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN '2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN '2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN '2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END) AS RD_CC,
RD_TIPO2 = 'I', (RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)) AS RD_MES, RD_STATUS = 'A'
FROM FicFin
INNER JOIN Funcionario FUN ON FUN.cvCodFun = FicFin.cvCodFun AND FUN.cdDatRes IS NULL
INNER JOIN Evento ON Evento.cvCodEve = FicFin.cvCodEve AND Evento.cvTipEve IN ('48','49','50', '51', '52')
WHERE FicFin.cvAnoFicFin >= '2012'-- AND FicFin.cvCodEve IN ('0080', '0081', '0109') --AND FUN.cvCodFil = '47'
AND FicFin.cvCodEve IN ('0001', '0008', '0051', '0270', '0172', '0621', '0283', '0036', '0943', '0782', '1324', '1635', '0175', '0096', '0842', '0836', '1437', '1641', '0353', 
'0980', '1024', '0176', '0061', '0099', '0123', '0703', '0865', '1025', '0791', '0014', '0057', '0016', '0058', '0658', '1621', '0015', '0059', '0657', '0212', '1118', 
'0066', '0009', '0010', '0017', '0738', '0739', '0840', '0213', '0007', '0044', '1215', '1630', '0006', '0025', '0075', '0084', '0217', '0076', '0026', '0077', '0052', 
'0018', '0078', '0079', '0043', '0115', '0280', '1441', '0743', '0048', '0373', '1628', '0060', '0174', '0700', '1327', '1085', '1643', '0277', '1103', '1644', '1591', 
'0368', '0198', '0042', '0211', '0050', '0263', '0294', '0236', '1457', '1645', '1646', '0642', '1631', '0074', '0022', '0209', '0665', '0167', '0027', '1150', '1414', 
'0820', '1544', '1632', '0845', '0063', '0281', '1548', '0039', '1647', '1642', '1648', '0944', '0178', '0219', '0011', '0091', '1409', '1226', '1192', '0625', '0122', 
'1627', '1509', '1036', '1054', '1636', '1653', '0227', '0249', '1634', '1652', '1655', '1656', '1328', '0231', '1547', '1624', '1422', '1065', '1089', '0181', '0184', 
'1571', '0029', '1573', '0776', '1649', '1640', '1546', '1453', '1106', '0019', '1651', '0684')
ORDER BY RD_MAT, RD_DATARQ, RD_PD

-- IMPORTAÇÃO DAS VERBAS, LIQUIDOS, TOTAL PROVENTOS E DESCONTOS
SELECT FUN.cvCodFil AS RD_FILIAL, RIGHT(FUN.ccVarFun,7) AS RD_MAT, 
(CASE FicFin.cvCodEve WHEN '0080'   
	THEN    '975' WHEN  '0081'  THEN    '974' WHEN  '0109'  THEN    '701' 
	ELSE 'XXX' END) AS RD_PD, RD_TIPO1 = 'V',
RD_HORAS = '0', SUM(FicFin.cvVlrFimFicFin) AS RD_VALOR,
(CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)) AS RD_DATARQ,
(CASE WHEN FicFin.cvCodEve='0211' 
AND (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'20') = '20120120'
THEN (CONVERT(VARCHAR,FicFin.cvAnoFicFin-1)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin+11),2)+'20')
WHEN FicFin.cvCodEve='0211' AND (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'20') <> '20120120'
THEN (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin-01),2)+'20')
ELSE (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'04') END )AS RD_DATPGT,
(CASE FUN.cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN '2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN '2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN '2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN '2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN '2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END) AS RD_CC,
RD_TIPO2 = 'I', (RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)) AS RD_MES, RD_STATUS = 'A'
FROM FicFin
INNER JOIN Funcionario FUN ON FUN.cvCodFun = FicFin.cvCodFun AND FUN.cdDatRes IS NULL
INNER JOIN Evento ON Evento.cvCodEve = FicFin.cvCodEve AND Evento.cvTipEve IN ('48','49','50', '51', '52')
WHERE FicFin.cvAnoFicFin >= '2012' AND FicFin.cvCodEve IN ('0080', '0081', '0109') AND FUN.cvCodFil IN ('72','75') 
GROUP BY FUN.cvCodFil,FUN.cvCodCdc, FUN.ccVarFun, FicFin.cvCodEve, FicFin.cvAnoFicFin, FicFin.cvMesFicFin
ORDER BY 8, 1, 2

-- ALTERAR A VERBA 092 PARA RD_TIPO1 = 'V' VIA SDU (VERBA DE DSR)