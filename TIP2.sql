SELECT (CASE FUN. cvCodFil WHEN '73' THEN '0C0 - EQUIPAV' WHEN '47' THEN '096 - SARPAV' WHEN'71' THEN '0A0 - MINERPAV'
WHEN '72' THEN '0A0 - LEVERG' WHEN '74' THEN '0B0 - MINERGOLD' WHEN '75' THEN '0A0 - LEVERG'ELSE '999' END ) AS RT_FILIAL,
RIGHT( FUN. ccVarFun ,7 ) AS RT_MAT,
RT_VERBA = '806' , FUN .cvSalFun AS SALARIO ,
CODEVENTO = ' ' , DESCRI = 'INSS FÉRIAS', RT_TIPPROV= '2' ,
insstemp.horastemp AS HORASTEMP,
((( (FicFin.cvVlrFimFicFin)/insstemp.horastemp))*(insstemp.horastemp-12))  AS "RT_VALOR" ,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )) AS RT_DATACAL ,
( CASE FUN .cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN   '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN'2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN'2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN'2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN'2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN'2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END ) AS RT_CC
FROM FicFin
INNER JOIN Funcionario FUN ON FUN. cvCodFun = FicFin. cvCodFun AND FUN. cdDatRes IS NULL
INNER JOIN Evento ON Evento . cvCodEve = FicFin . cvCodEve AND Evento . cvTipEve IN ( '52')
INNER JOIN INSSTEMP ON INSSTEMP.mattemp = RIGHT( FUN.ccVarFun ,7 ) AND INSSTEMP.FILIALtemp =  FUN. cvCodFil and horastemp >= '13'
WHERE (CONVERT ( VARCHAR, FicFin .cvAnoFicFin )+ RIGHT( '00' + RTRIM (FicFin . cvMesFicFin), 2 ))  = '201312' AND
FicFin .cvCodEve in ('87')
AND FicFin.cvVlrBasFicFin >= '13'
GROUP BY FUN. cvCodFil , RIGHT( FUN. ccVarFun ,7 ), FUN.cvSalFun ,insstemp.horastemp, FicFin .cvVlrFimFicFin,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )), FUN .cvCodCdc

UNION ALL

SELECT (CASE FUN. cvCodFil WHEN '73' THEN '0C0 - EQUIPAV' WHEN '47' THEN '096 - SARPAV' WHEN'71' THEN '0A0 - MINERPAV'
WHEN '72' THEN '0A0 - LEVERG' WHEN '74' THEN '0B0 - MINERGOLD' WHEN '75' THEN '0A0 - LEVERG'ELSE '999' END ) AS RT_FILIAL,
RIGHT( FUN. ccVarFun ,7 ) AS RT_MAT,
RT_VERBA = '808' , FUN .cvSalFun AS SALARIO ,
CODEVENTO = ' ' , DESCRI = 'FGTS FÉRIAS', RT_TIPPROV= '2' ,
FicFin .cvVlrBasFicFin AS RT_HORAS ,
((( (((MAX(FicFin .cvVlrFimFicFin)*100)/ 133.333333 )/3)/FicFin.cvVlrBasFicFin)*(FicFin.cvVlrBasFicFin-12)+(((MAX(FicFin .cvVlrFimFicFin)*100)/ 133.333333 )/FicFin.cvVlrBasFicFin)*(FicFin.cvVlrBasFicFin-12))*0.08)  AS "RT_VALOR" ,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )) AS RT_DATACAL ,
( CASE FUN .cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN   '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN'2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN'2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN'2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN'2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN'2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END ) AS RT_CC
FROM FicFin
INNER JOIN Funcionario FUN ON FUN. cvCodFun = FicFin. cvCodFun AND FUN. cdDatRes IS NULL
INNER JOIN Evento ON Evento . cvCodEve = FicFin . cvCodEve AND Evento . cvTipEve IN ( '52')
WHERE (CONVERT ( VARCHAR, FicFin .cvAnoFicFin )+ RIGHT( '00' + RTRIM (FicFin . cvMesFicFin), 2 ))  = '201312' AND
FicFin .cvCodEve in ( '67', '1279' )
AND FicFin.cvVlrBasFicFin >= '13'
GROUP BY FUN. cvCodFil , RIGHT( FUN. ccVarFun ,7 ), FicFin. cvVlrBasFicFin , FUN .cvSalFun ,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )), FUN .cvCodCdc

UNION ALL

SELECT (CASE FUN. cvCodFil WHEN '73' THEN '0C0 - EQUIPAV' WHEN '47' THEN '096 - SARPAV' WHEN'71' THEN '0A0 - MINERPAV'
WHEN '72' THEN '0A0 - LEVERG' WHEN '74' THEN '0B0 - MINERGOLD' WHEN '75' THEN '0A0 - LEVERG'ELSE '999' END ) AS RT_FILIAL,
RIGHT( FUN. ccVarFun ,7 ) AS RT_MAT,
RT_VERBA = '804' , FUN .cvSalFun AS SALARIO ,
CODEVENTO = ' ' , DESCRI = 'PROV FÉRIAS', RT_TIPPROV= '2' ,
FicFin .cvVlrBasFicFin AS RT_HORAS ,
(( ((FicFin.cvVlrFimFicFin * 100) / 133.333333 )/FicFin.cvVlrBasFicFin)*(FicFin.cvVlrBasFicFin-12))  AS "RT_VALOR",
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )) AS RT_DATACAL ,
( CASE FUN .cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN   '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN'2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN'2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN'2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN'2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN'2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END ) AS RT_CC
FROM FicFin
INNER JOIN Funcionario FUN ON FUN. cvCodFun = FicFin. cvCodFun AND FUN. cdDatRes IS NULL
INNER JOIN Evento ON Evento . cvCodEve = FicFin . cvCodEve AND Evento . cvTipEve IN ( '52')
WHERE (CONVERT ( VARCHAR, FicFin .cvAnoFicFin )+ RIGHT( '00' + RTRIM (FicFin . cvMesFicFin), 2 ))  = '201312' AND
FicFin .cvCodEve in ('67')
AND FicFin.cvVlrBasFicFin >= '13'
AND RIGHT(FUN.ccVarFun,7) IN ('002143','003042','003250','003255','003256','003257','003265','005347','005487','005680',
'005683','005692','005706','005713','005754','005759','005764','005765','005771')

UNION ALL

SELECT (CASE FUN. cvCodFil WHEN '73' THEN '0C0 - EQUIPAV' WHEN '47' THEN '096 - SARPAV' WHEN'71' THEN '0A0 - MINERPAV'
WHEN '72' THEN '0A0 - LEVERG' WHEN '74' THEN '0B0 - MINERGOLD' WHEN '75' THEN '0A0 - LEVERG'ELSE '999' END ) AS RT_FILIAL,
RIGHT( FUN. ccVarFun ,7 ) AS RT_MAT,
RT_VERBA = '804' , FUN .cvSalFun AS SALARIO ,
CODEVENTO = ' ' , DESCRI = 'PROV FÉRIAS', RT_TIPPROV= '2' ,
FicFin .cvVlrBasFicFin AS RT_HORAS ,
( ((((MAX(FicFin .cvVlrFimFicFin) - MIN(FicFin .cvVlrFimFicFin)) * 100) / 133.333333 )/FicFin.cvVlrBasFicFin)*(FicFin.cvVlrBasFicFin-12))  AS "RT_VALOR",
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )) AS RT_DATACAL ,
( CASE FUN .cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN   '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN'2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN'2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN'2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN'2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN'2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END ) AS RT_CC
FROM FicFin
INNER JOIN Funcionario FUN ON FUN. cvCodFun = FicFin. cvCodFun AND FUN. cdDatRes IS NULL
INNER JOIN Evento ON Evento . cvCodEve = FicFin . cvCodEve AND Evento . cvTipEve IN ( '52')
WHERE (CONVERT ( VARCHAR, FicFin .cvAnoFicFin )+ RIGHT( '00' + RTRIM (FicFin . cvMesFicFin), 2 ))  = '201312' AND
FicFin .cvCodEve in ( '67', '1279' )
AND RIGHT(FUN.ccVarFun,7) NOT IN ('002143','003042','003250','003255','003256','003257','003265','005347','005487','005680',
'005683','005692','005706','005713','005754','005759','005764','005765','005771')
AND FicFin.cvVlrBasFicFin >= '13'
GROUP BY FUN. cvCodFil , RIGHT( FUN. ccVarFun ,7 ), FicFin. cvVlrBasFicFin , FUN .cvSalFun ,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )), FUN .cvCodCdc


UNION ALL

SELECT (CASE FUN.cvCodFil WHEN '73' THEN '0C0 - EQUIPAV' WHEN '47' THEN '096 - SARPAV' WHEN'71' THEN '0A0 - MINERPAV'
WHEN '72' THEN '0A0 - LEVERG' WHEN '74' THEN '0B0 - MINERGOLD' WHEN '75' THEN '0A0 - LEVERG'ELSE '999' END ) AS RT_FILIAL,
RIGHT( FUN.ccVarFun ,7 ) AS RT_MAT,
RT_VERBA = '803' , FUN.cvSalFun AS SALARIO ,
CODEVENTO = ' ' , DESCRI = 'PROV FÉRIAS MEDIAS', RT_TIPPROV= '2' ,
FicFin.cvVlrBasFicFin AS RT_HORAS ,
(( (((FicFin.cvVlrFimFicFin) * 100) / 133.333333 )/FicFin.cvVlrBasFicFin)*(FicFin.cvVlrBasFicFin-12))  AS "RT_VALOR",
( CONVERT( VARCHAR ,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin.cvMesFicFin), 2 )) AS RT_DATACAL ,
( CASE FUN.cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN   '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN'2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN'2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN'2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN'2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN'2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END ) AS RT_CC
FROM FicFin
INNER JOIN Funcionario FUN ON FUN.cvCodFun = FicFin.cvCodFun AND FUN.cdDatRes IS NULL
INNER JOIN Evento ON Evento . cvCodEve = FicFin . cvCodEve AND Evento.cvTipEve IN ( '52')
WHERE (CONVERT ( VARCHAR, FicFin.cvAnoFicFin )+ RIGHT( '00' + RTRIM (FicFin.cvMesFicFin), 2 ))  = '201312' AND
FicFin.cvCodEve in ('1279' )
AND RIGHT(FUN.ccVarFun,7) NOT IN ('002143','003042','003250','003255','003256','003257','003265','005347','005487','005680',
'005683','005692','005706','005713','005754','005759','005764','005765','005771')
AND FicFin.cvVlrBasFicFin >= '13'

UNION ALL

SELECT (CASE FUN. cvCodFil WHEN '73' THEN '0C0 - EQUIPAV' WHEN '47' THEN '096 - SARPAV' WHEN'71' THEN '0A0 - MINERPAV'
WHEN '72' THEN '0A0 - LEVERG' WHEN '74' THEN '0B0 - MINERGOLD' WHEN '75' THEN '0A0 - LEVERG'ELSE '999' END ) AS RT_FILIAL,
RIGHT( FUN. ccVarFun ,7 ) AS RT_MAT,
RT_VERBA = '802' , FUN .cvSalFun AS SALARIO ,
CODEVENTO = ' ' , DESCRI = 'PROV 1/3 FÉRIAS', RT_TIPPROV= '2' ,
FicFin .cvVlrBasFicFin AS RT_HORAS ,
(((( ((MAX(FicFin .cvVlrFimFicFin)*100)/ 133.333333 )/3 )/FicFin.cvVlrBasFicFin)*(FicFin.cvVlrBasFicFin-12)))  AS "RT_VALOR" ,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )) AS RT_DATACAL ,
( CASE FUN .cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN   '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN'2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN'2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN'2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN'2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN'2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END ) AS RT_CC
FROM FicFin
INNER JOIN Funcionario FUN ON FUN. cvCodFun = FicFin. cvCodFun AND FUN. cdDatRes IS NULL
INNER JOIN Evento ON Evento . cvCodEve = FicFin . cvCodEve AND Evento . cvTipEve IN ( '52')
WHERE (CONVERT ( VARCHAR, FicFin .cvAnoFicFin )+ RIGHT( '00' + RTRIM (FicFin . cvMesFicFin), 2 ))  = '201312' AND
FicFin .cvCodEve in ( '67', '1279' )
AND FicFin.cvVlrBasFicFin >= '13'
GROUP BY FUN. cvCodFil , RIGHT( FUN. ccVarFun ,7 ), FicFin. cvVlrBasFicFin , FUN .cvSalFun ,
( CONVERT( VARCHAR ,FicFin . cvAnoFicFin)+ RIGHT('00' + RTRIM (FicFin . cvMesFicFin), 2 )), FUN .cvCodCdc


ORDER BY RT_MAT, RT_DATACAL, RT_VERBA

