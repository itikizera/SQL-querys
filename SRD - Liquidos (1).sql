SELECT FUN.cvCodFil AS RD_FILIAL, RIGHT(FUN.ccVarFun,7) AS RD_MAT, 
(CASE FicFin.cvCodEve WHEN '0080'   
	THEN    '975' WHEN  '0081'  THEN    '974' WHEN  '0109'  THEN    '701' 
	ELSE 'XXX' END) AS RD_PD, RD_TIPO1 = 'V',
RD_HORAS = '0', SUM(FicFin.cvVlrFimFicFin) AS RD_VALOR,
(CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)) AS RD_DATARQ,
(CASE WHEN FicFin.cvCodEve='0211' 
AND (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'20') = '20120120'
THEN (CONVERT(VARCHAR,FicFin.cvAnoFicFin-1)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin+11),2)+'20')
WHEN FicFin.cvCodEve='0211' AND (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'20') <> '20120120'
THEN (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin-01),2)+'20')
ELSE (CONVERT(VARCHAR,FicFin.cvAnoFicFin)+ RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)+'04') END )AS RD_DATPGT,
(CASE FUN.cvCodCdc WHEN '2273' THEN '020101008' WHEN '2260' THEN '030101001' WHEN '2253' THEN '020201001' WHEN '2271' THEN '020201007' WHEN '2272' THEN '030101002'
WHEN '2267' THEN '020201003' WHEN '2266' THEN '020201002' WHEN '2265' THEN '020101005' WHEN '2269' THEN '020201005' WHEN '2239' THEN '010201999'
WHEN '2241' THEN '010203999' WHEN '2275' THEN '010408999' WHEN '2238' THEN '010104999' WHEN '2274' THEN '020201008' WHEN '2244' THEN '010302999'
WHEN '2276' THEN '990199001' WHEN '2242' THEN '010205999' WHEN '2247' THEN '010407999' WHEN '2237' THEN '010103999' WHEN '2243' THEN '010301999'
WHEN '2236' THEN '010101999' WHEN '2245' THEN '010401999' WHEN '2246' THEN '010402999' WHEN '2240' THEN '010202999' WHEN '2270' THEN '020201006'
WHEN '2268' THEN '020101004' WHEN '2262' THEN '020101002' WHEN '2264' THEN '020101004' WHEN '2263' THEN '020101003' WHEN '2248' THEN '020101001'
WHEN '2277' THEN '' ELSE 'XXX' END) AS RD_CC,
RD_TIPO2 = 'I', (RIGHT('00' + RTRIM(FicFin.cvMesFicFin),2)) AS RD_MES, RD_STATUS = 'A'
FROM FicFin
INNER JOIN Funcionario FUN ON FUN.cvCodFun = FicFin.cvCodFun AND FUN.cdDatRes IS NULL
INNER JOIN Evento ON Evento.cvCodEve = FicFin.cvCodEve AND Evento.cvTipEve IN ('48','49','50', '51', '52')
WHERE FicFin.cvAnoFicFin >= '2012' AND FicFin.cvCodEve IN ('0080', '0081', '0109') AND FUN.cvCodFil IN ('72','75') 
GROUP BY FUN.cvCodFil,FUN.cvCodCdc, FUN.ccVarFun, FicFin.cvCodEve, FicFin.cvAnoFicFin, FicFin.cvMesFicFin
ORDER BY 8, 1, 2